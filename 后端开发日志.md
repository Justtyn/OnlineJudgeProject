# 在线判题系统后端开发日志

## 项目概述

本项目是一个基于Spring Boot的在线判题系统后端服务，为前端Vue应用提供RESTful API接口。系统支持学生、教师和管理员三种角色的用户管理，提供题目管理、作业管理、讨论区、统计分析等核心功能。

## 技术栈分析

### 核心框架
- **Spring Boot 2.6.13**: 主框架，提供自动配置和快速开发能力
- **Java 1.8**: 开发语言版本
- **Maven**: 项目构建和依赖管理工具

### 数据持久层
- **MyBatis Plus 3.5.3.1**: ORM框架，简化数据库操作
- **MyBatis Spring Boot Starter 2.2.1**: MyBatis与Spring Boot集成
- **MySQL**: 关系型数据库
- **PageHelper 1.4.6**: 分页插件

### 安全认证
- **JWT (JSON Web Token)**: 无状态身份认证
  - `java-jwt 3.10.3`: Auth0 JWT库
  - `jjwt 0.11.5`: 另一个JWT实现库
- **自定义JWT工具类**: 实现token生成和解析

### 工具库
- **Lombok 1.18.30**: 减少样板代码，自动生成getter/setter等方法
- **Hutool 5.8.24**: Java工具类库，提供常用工具方法
- **Spring Boot Mail**: 邮件发送功能

### API文档
- **Swagger 3.0.0**: API文档生成和测试工具
- **SpringFox Boot Starter**: Swagger与Spring Boot集成

### 其他功能
- **Spring Boot Web**: Web应用开发
- **Spring Boot Test**: 单元测试支持
- **Spring Scheduling**: 定时任务支持

## 项目架构

### 包结构设计
```
com.example.onlinejudge/
├── common/           # 公共组件
│   ├── CorsConfig.java        # 跨域配置
│   ├── Result.java            # 统一返回结果封装
│   └── RoleEnum.java          # 角色枚举
├── config/           # 配置类
│   ├── MybatisPlusConfig.java # MyBatis Plus配置
│   ├── SwaggerConfig.java     # Swagger配置
│   └── WebMvcConfig.java      # Web MVC配置
├── controller/       # 控制器层
│   ├── AnnouncementController.java    # 公告管理控制器
│   ├── CourseController.java          # 课程管理控制器
│   ├── DataAnalysisController.java    # 数据分析控制器
│   ├── DiscussCommentController.java  # 讨论评论控制器
│   ├── DiscussController.java         # 讨论区管理控制器
│   ├── HomeworkController.java        # 作业管理控制器
│   ├── HomeworkProblemController.java # 作业题目控制器
│   ├── ProblemController.java         # 题目管理控制器
│   ├── SolutionController.java        # 题解管理控制器
│   ├── StatsController.java           # 统计控制器
│   ├── StatusController.java          # 状态管理控制器
│   ├── StudentController.java         # 学生管理控制器
│   ├── TeacherController.java         # 教师管理控制器
│   └── WebController.java             # Web控制器
├── entity/           # 实体类
│   ├── Account.java          # 账户实体
│   ├── Admin.java            # 管理员实体
│   ├── Announcement.java     # 公告实体
│   ├── Course.java           # 课程实体
│   ├── Discuss.java          # 讨论实体
│   ├── DiscussComment.java   # 讨论评论实体
│   ├── Homework.java         # 作业实体
│   ├── HomeworkProblem.java  # 作业题目实体
│   ├── Problem.java          # 题目实体
│   ├── Solution.java         # 题解实体
│   ├── Status.java           # 状态实体
│   ├── Student.java          # 学生实体
│   └── Teacher.java          # 教师实体
├── exception/        # 异常处理
│   ├── CustomException.java      # 自定义异常
│   └── GlobalExceptionHandler.java # 全局异常处理器
├── mapper/           # 数据访问层
│   ├── AdminMapper.java           # 管理员数据访问
│   ├── AnnouncementMapper.java    # 公告数据访问
│   ├── CourseMapper.java          # 课程数据访问
│   ├── DiscussCommentMapper.java  # 讨论评论数据访问
│   ├── DiscussMapper.java         # 讨论数据访问
│   ├── HomeworkMapper.java        # 作业数据访问
│   ├── HomeworkProblemMapper.java # 作业题目数据访问
│   ├── ProblemMapper.java         # 题目数据访问
│   ├── ScoreMapper.java           # 分数数据访问
│   ├── SolutionMapper.java        # 题解数据访问
│   ├── StatsMapper.java           # 统计数据访问
│   ├── StatusMapper.java          # 状态数据访问
│   ├── StudentMapper.java         # 学生数据访问
│   └── TeacherMapper.java         # 教师数据访问
├── service/          # 业务逻辑层
│   ├── impl/         # 服务实现类
│   │   ├── AnnouncementServiceImpl.java    # 公告服务实现
│   │   ├── CourseServiceImpl.java          # 课程服务实现
│   │   ├── DiscussServiceImpl.java         # 讨论服务实现
│   │   ├── HomeworkProblemServiceImpl.java # 作业题目服务实现
│   │   ├── HomeworkServiceImpl.java        # 作业服务实现
│   │   ├── ProblemServiceImpl.java         # 题目服务实现
│   │   ├── ScoreServiceImpl.java           # 分数服务实现
│   │   ├── SolutionServiceImpl.java        # 题解服务实现
│   │   ├── StatsServiceImpl.java           # 统计服务实现
│   │   ├── StatusServiceImpl.java          # 状态服务实现
│   │   ├── StudentServiceImpl.java         # 学生服务实现
│   │   └── TeacherServiceImpl.java         # 教师服务实现
│   ├── AdminService.java           # 管理员服务接口
│   ├── AnnouncementService.java    # 公告服务接口
│   ├── CourseService.java          # 课程服务接口
│   ├── DiscussCommentService.java  # 讨论评论服务接口
│   ├── DiscussService.java         # 讨论服务接口
│   ├── HomeworkProblemService.java # 作业题目服务接口
│   ├── HomeworkService.java        # 作业服务接口
│   ├── MailService.java            # 邮件服务接口
│   ├── ProblemService.java         # 题目服务接口
│   ├── ScoreService.java           # 分数服务接口
│   ├── SolutionService.java        # 题解服务接口
│   ├── StatsService.java           # 统计服务接口
│   ├── StatusService.java          # 状态服务接口
│   ├── StudentService.java         # 学生服务接口
│   └── TeacherService.java         # 教师服务接口
├── task/            # 定时任务
│   ├── DailyChallengeResetTask.java # 每日挑战重置任务
│   └── DailyProblemResetTask.java   # 每日题目重置任务
├── utils/            # 工具类
│   ├── FilterConfig.java            # 过滤器配置
│   ├── JwtAuthenticationFilter.java # JWT认证过滤器
│   └── JwtUtil.java                 # JWT工具类
└── OnlineJudgeApplication.java      # Spring Boot启动类
```

### 核心实体设计

#### Problem实体
- 题目基本信息：ID、名称、出题人、创建时间
- 统计信息：通过次数(acCount)、提交次数(submitCount)
- 题目内容：描述、输入输出格式、样例、提示
- 特殊功能：每日挑战标记(dailyChallenge)

#### Student实体
- 继承Admin基类，包含基础用户信息
- 学习统计：AC数、提交数、总分数
- 个人信息：背景介绍、学校、最后登录时间
- 系统功能：班级ID、每日挑战记录

#### Teacher实体
- 教师基本信息：ID、用户名、密码、姓名
- 联系信息：性别、电话、邮箱
- 系统信息：头像、角色、所属班级ID

## 核心功能实现

### 1. 用户认证与授权
- **JWT Token机制**: 实现无状态身份认证
- **角色权限控制**: 支持学生、教师、管理员三种角色
- **密码安全**: 支持密码修改和找回功能
- **邮箱验证**: 通过邮件服务实现密码重置

### 2. 题目管理系统
- **CRUD操作**: 完整的题目增删改查功能
- **分页查询**: 支持按页码和每页数量查询
- **多条件搜索**: 支持按名称、出题人、关键词搜索
- **统计更新**: 自动更新题目通过数和提交数
- **每日挑战**: 特殊题目类型管理

### 3. 学生管理系统
- **用户管理**: 学生注册、信息修改、删除
- **头像上传**: 支持图片文件上传功能
- **背景设置**: 个性化背景图片设置
- **学习统计**: AC数、提交数自动统计
- **排名系统**: 按AC数排序的学生排名
- **多维度搜索**: 支持按用户名、姓名、年份搜索

### 4. 作业管理
- **作业创建**: 教师可创建作业并关联题目
- **作业分配**: 将作业分配给特定班级或学生
- **提交管理**: 学生作业提交和状态跟踪
- **成绩统计**: 作业完成情况和成绩分析

### 5. 讨论区功能
- **讨论发布**: 学生和教师可发布讨论
- **评论系统**: 支持对讨论进行评论
- **内容管理**: 管理员可管理讨论内容

### 6. 数据分析
- **统计报表**: 系统使用情况统计
- **学习分析**: 学生学习进度分析
- **题目分析**: 题目难度和通过率分析

## 技术特色

### 1. 统一返回结果封装
使用`Result`类统一封装API返回结果，包含状态码、消息和数据，确保前端接口调用的一致性。

### 2. 异常处理机制
- 自定义异常类`CustomException`
- 全局异常处理器`GlobalExceptionHandler`
- 统一的错误处理和响应格式

### 3. 跨域支持
通过`CorsConfig`配置CORS策略，支持前后端分离架构的跨域请求。

### 4. 定时任务
- 每日挑战重置任务
- 每日题目重置任务
- 使用Spring的`@EnableScheduling`注解启用定时任务

### 5. 文件上传处理
- 支持头像和背景图片上传
- 静态资源访问配置
- 文件存储路径管理

## 数据库设计

### 主要数据表
- **problem**: 题目信息表
- **student**: 学生信息表
- **teacher**: 教师信息表
- **admin**: 管理员信息表
- **homework**: 作业信息表
- **discuss**: 讨论信息表
- **solution**: 解题记录表
- **status**: 提交状态表

### 数据库配置
- 使用MySQL 8.0数据库
- 字符编码：UTF-8
- 时区设置：GMT+8
- 连接池配置优化

## 部署配置

### 应用配置
- **端口**: 9090
- **静态资源**: 支持文件上传和访问
- **日志级别**: DEBUG级别，便于开发调试
- **Swagger**: 启用API文档访问

### 邮件服务
- 使用QQ邮箱SMTP服务
- 支持TLS加密
- 用于密码重置和通知功能

## 开发规范

### 代码规范
- 使用Lombok减少样板代码
- 统一的命名规范
- 完整的注释和文档
- Swagger注解规范API文档

### 安全考虑
- JWT密钥管理
- 密码加密存储
- 输入参数验证
- SQL注入防护

## 性能优化

### 数据库优化
- 使用MyBatis Plus简化SQL操作
- 分页查询减少数据传输
- 索引优化查询性能

### 缓存策略
- 静态资源缓存
- 用户会话管理
- 查询结果缓存

## 参考文献

1. Spring Boot官方文档: https://spring.io/projects/spring-boot
2. MyBatis Plus官方文档: https://baomidou.com/
3. JWT官方规范: https://tools.ietf.org/html/rfc7519
4. Swagger官方文档: https://swagger.io/
5. Lombok官方文档: https://projectlombok.org/
6. Hutool工具库: https://hutool.cn/
7. MySQL官方文档: https://dev.mysql.com/doc/
8. Maven官方文档: https://maven.apache.org/

## 总结

本后端系统采用现代化的Spring Boot架构，结合MyBatis Plus实现高效的数据访问，通过JWT实现安全的用户认证，使用Swagger提供完整的API文档。系统设计合理，功能完善，具有良好的可扩展性和维护性，为在线判题系统提供了稳定可靠的后端服务支持。
